<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Architectural Overview - Yakut</title>


        <!-- Custom HTML head -->

        <meta name="description" content="A dynamic and modular penetration testing framework and exploit development platform.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Yakut</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/ardytstrn/yakut" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/ardytstrn/docs/edit/main/docs/developer-guide/architectural-overview.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="architectural-overview"><a class="header" href="#architectural-overview">Architectural Overview</a></h1>
<p>Understanding the high-level architecture of Yakut is crucial for both module developers
and those wishing to contribute to its core. Yakut is designed as a collection of
interconnected, yet largely independent, components that work together to provide a
comprehensive penetration testing environment.</p>
<h2 id="1-core-architectural-tenets"><a class="header" href="#1-core-architectural-tenets">1. Core Architectural Tenets</a></h2>
<ul>
<li>Function-centric microservices-inspired design</li>
<li>Intelligence-driven operations</li>
<li>Layered extensibility
<ul>
<li>Capabilities</li>
<li>Core services</li>
<li>Interface adapters</li>
</ul>
</li>
<li>API-first principle</li>
<li>Asynchronous &amp; event-driven paradigm</li>
</ul>
<h2 id="2-high-level-component-diagram"><a class="header" href="#2-high-level-component-diagram">2. High-Level Component Diagram</a></h2>
<p><img src="../component-diagram.png" alt="Diagram" /></p>
<h2 id="3-detailed-component-breakdown"><a class="header" href="#3-detailed-component-breakdown">3. Detailed Component Breakdown</a></h2>
<h3 id="31-yakutkernel"><a class="header" href="#31-yakutkernel">3.1. <code>Yakut::Kernel</code></a></h3>
<p>The Kernel is the immutable core. It provides the fundational runtime and system-level services. It does not contain business logic related to penetration testing itself but enables all other components.</p>
<ul>
<li><code>LifecycleManager</code>: Manages the boot sequence (dependency injection, service initialization order), health checks of core services and coordinated shutdown.</li>
<li><code>EventFabric</code>: Facilitates asynchronous, decoupled communication via a publish-subscribe model.</li>
<li><code>ConfigSubsystem</code>: Loads, merges and provides access to configurations from files.</li>
<li><code>LoggingSubsystem</code>: Provides a centralized and structured logging facility.</li>
<li><code>TaskScheduler</code>: Manages the execution of asynchronous tasks, primarily capability runs initiated with <code>--async</code>.</li>
<li><code>InternalAPIGateway</code>: Acts as a unified, versioned Facade for all core framework services. This is the <em>sole entry point</em> for <code>InterfaceAdapters</code> and for structured inter-component API calls. It exposes well-defined Ruby methods. Handles request routing to the appropriate Engine/Platform, basic request validation and API versioning. Not an HTTP gateway.</li>
<li><code>SecurityCore</code>: Manages framework security aspects, primarily focused on secure secret maangement.</li>
</ul>
<h3 id="32-yakutcognitionengine"><a class="header" href="#32-yakutcognitionengine">3.2. <code>Yakut::CognitionEngine</code></a></h3>
<p>The data and intelligence hub, transforms raw data into a structured understanding of the engagement.</p>
<ul>
<li><code>Workspace &amp; DataStore Management</code>: Manages Workspace lifecycle and data persistence.</li>
<li><code>TargetGraph</code>: Represents targets and their interconnections as a graph.</li>
<li><code>LootParserFramework</code>: Ingests and parses various types of loot.</li>
<li><code>VulnIntelAggregator</code>: Aggregates and enriches vulnerability data.</li>
<li><code>IntelIngestionPipeline</code>: Processes data from <code>Intel</code> capabilities and external feeds.</li>
<li><code>ScopeEnforcementService</code>: Checks if a proposed action/target is within the defined Workspace scope.</li>
</ul>
<h3 id="33-yakutoperationsplatform"><a class="header" href="#33-yakutoperationsplatform">3.3. <code>Yakut::OperationsPlatform</code></a></h3>
<p>The engine for executing all active offensive, defensive and utility capabilities.</p>
<ul>
<li><code>CapabilityRegistry</code>: Discovers, loads, validates, and manages capabilities.</li>
<li><code>ExecutionEngine</code>: Provides the runtime environment for executing <code>check</code>, <code>run</code> and <code>cleanup</code> methods of capabilities.</li>
<li><code>PayloadGenerationService</code>: Generates and configures payloads.</li>
<li><code>SessionOrchestrationService</code>: Manages the logical state and interaction API for active C2 sessions.</li>
<li><code>EvasionServices</code>: Provides on-demand evasion techniques. It is a collection of Ruby classes/modules implementing various obfuscation, encoding, process injection or anti-analysis techniques.</li>
<li><code>YSL (Yakut Standard Library)</code>: A curated set of Ruby mixins, utility classes, and functions provided to capability developers.</li>
</ul>
<h3 id="34-yakutc2infrastructure"><a class="header" href="#34-yakutc2infrastructure">3.4. <code>Yakut::C2Infrastructure</code></a></h3>
<p>Manages the network communication aspects of Command and Control.</p>
<ul>
<li><code>ListenerManager</code>: Binds to network ports and accepts incoming connections for various C2 protocols.</li>
<li><code>C2ChannelFactory</code>: Creates and manages instances of specific C2 communication channels based on listener type and payload configuration.</li>
<li><code>C2ProfileEngine</code>: Applies malleable C2 profiles to active listeners and channels.</li>
<li><code>Routing &amp; Pivoting Subsystem</code>: Manages network routes through compromised hosts (pivots). Interacts with active YakutAgent sessions to set up SOCKS proxies or port forwards on compromised hosts. Maintains an internal routing table that other Capabilities can use to direct their traffic through pivots. May involve low-level packet manipulation or dynamic proxying logic.</li>
</ul>
<h3 id="35-yakutcampaignorchestrator"><a class="header" href="#35-yakutcampaignorchestrator">3.5. <code>Yakut::CampaignOrchestrator</code></a></h3>
<p>The strategic automation engine for complex, multi-stage operations.</p>
<ul>
<li><code>WorkflowEngine</code>: Executes <code>Orchestration</code> capabilities.</li>
<li><code>CampaignLifecycleManager</code>: Manages the overall lifecycle of defined Campaigns (objectives, status, associated Workspaces, timelines).</li>
<li><code>ConditionalLogicEvaluator</code>: Evaluates conditions within orchestration workflows.</li>
</ul>
<h3 id="36-yakutinterfaceadapters"><a class="header" href="#36-yakutinterfaceadapters">3.6. <code>Yakut::InterfaceAdapters</code></a></h3>
<p>Provides external interfaces to the Yakut ecosystem.</p>
<ul>
<li><code>Yakut::CLIAdapter</code> (<code>yakut-console</code>): The primary interactive command-line interface.</li>
<li>(Future) <code>Yakut::WebUIAdapter</code>: Could be a Ruby web framework (Rails, Sinatra, ...) application that communicates with the <code>Yakut::Kernel</code> via the <code>InternalAPIGateway</code>.</li>
<li>(Future) <code>Yakut::ExternalAPIAdapter</code>: Could expose a RESTful (e.g., using Grape or Rails API) or gRPC interface. Requests would be authenticated and then translated into calls to the <code>InternalAPIGateway</code>.</li>
</ul>
<h2 id="4-data-flow--interaction-patterns"><a class="header" href="#4-data-flow--interaction-patterns">4. Data Flow &amp; Interaction Patterns</a></h2>
<ul>
<li><strong>Synchronous control flow:</strong> User commands from the <code>CLIAdapter</code> typically result in synchronous calls through the <code>InternalAPIGateway</code> to components like <code>OperationsPlatform</code> (to run a Capability) or <code>CognitionEngine</code> (to query data).</li>
<li><strong>Asynchronous event flow:</strong> Discoveries (new hosts, vulns, loot) or state changes (session opened, job completed) are published as events on the <code>EventFabric</code>. Other components subscribe to these events to react appropriately (e.g., <code>CognitionEngine</code> updates its DataStore, <code>CLIAdapter</code> shows a notification).</li>
</ul>
<h3 id="41-capability-execution-lifecycle"><a class="header" href="#41-capability-execution-lifecycle">4.1. Capability Execution Lifecycle</a></h3>
<ol>
<li>User selects and configures a Capability via <code>CLIAdapter</code>.</li>
<li><code>CLIAdapter</code> requests <code>OperationsPlatform</code> to execute the Capability.</li>
<li><code>OperationsPlatform::ExecutionEngine</code> instantiates the Capability, injects options and YSL access.</li>
<li>Capability code runs, using YSL and internal APIs to interact with targets, generate payloads (via <code>PayloadGenerationService</code>), report loot/vulns (to <code>CognitionEngine</code>) and log messages (to <code>LoggingSubsystem</code>).</li>
<li>Results and status are returned to <code>OperationsPlatform</code>, which then publishes completion events and returns structured output to the <code>CLIAdapter</code>.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../developer-guide/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../developer-guide/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
